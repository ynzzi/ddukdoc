<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>문의 등록</title>
  <meta charset="UTF-8">
</head>
<body>
<h2>문의 등록</h2>
<form id="qnaForm">
  <input type="hidden" id="doctorId" th:value="${doctorId}">
  <p>
    <label>제목:</label><br>
    <input type="text" id="title" style="width: 100%;">
  </p>
  <p>
    <label>내용:</label><br>
    <textarea id="content" style="width: 100%; height: 150px;"></textarea>
  </p>
  <button type="button" id="submitBtn">등록</button>
</form>

<script>
  document.getElementById("submitBtn").addEventListener("click", async function () {
      const token = localStorage.getItem("token");
      const doctorId = document.getElementById("doctorId").value;
      const title = document.getElementById("title").value.trim();
      const content = document.getElementById("content").value.trim();

      if (!title || !content) {
          alert("제목과 내용을 모두 입력해주세요.");
          return;
      }

      const res = await fetch("/api/qna/new", {
          method: "POST",
          headers: {
              "Content-Type": "application/json",
              "Authorization": token
          },
          body: JSON.stringify({
              doctorId: doctorId,
              title: title,
              content: content
          })
      });

      if (res.ok) {
          alert("문의가 등록되었습니다.");
          location.href = "/dept/list"; // 목록 페이지로 이동
      } else {
          alert("등록 실패");
      }
  });
</script>
</body>
</html>
